<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PDF to JPG (ZIP)</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(to right, #1f1c2c, #928dab);
    color: white;
    text-align: center;
    padding: 40px;
  }
  .container {
    background: rgba(255,255,255,0.1);
    padding: 25px;
    border-radius: 14px;
    max-width: 650px;
    margin: auto;
    box-shadow: 0 8px 20px rgba(0,0,0,0.5);
  }
  input, button {
    margin: 12px;
    padding: 12px 18px;
    border-radius: 8px;
    border: none;
    font-size: 15px;
  }
  button {
    background: #27ae60;
    color: white;
    cursor: pointer;
  }
  button:hover { background: #2ecc71; }
  .download-btn {
    display: block;
    margin: 15px auto;
    background: #ff9800;
    color: white;
    padding: 12px 22px;
    text-decoration: none;
    border-radius: 8px;
    font-weight: bold;
  }
  .download-btn:hover { background: #e68900; }
  canvas { margin:10px auto; max-width:100%; border:2px solid rgba(255,255,255,0.2); border-radius:8px; }
</style>
</head>
<body>
<div class="container">
  <h1>üìÑ PDF ‚Üí JPG (ZIP)</h1>
  <input type="file" id="pdfFile" accept="application/pdf">
  <button onclick="convertPDF()">Convert</button>
  <a id="zipDownload" class="download-btn" style="display:none;">‚¨áÔ∏è Download All (ZIP)</a>
  <div id="output"></div>
</div>

<!-- Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<script>
async function convertPDF() {
  const file = document.getElementById("pdfFile").files[0];
  if(!file){ alert("Upload PDF first!"); return; }

  const reader = new FileReader();
  reader.onload = async function(e){
    const typedarray = new Uint8Array(e.target.result);
    const pdf = await pdfjsLib.getDocument(typedarray).promise;
    const outputDiv = document.getElementById("output");
    outputDiv.innerHTML = "";

    const zip = new JSZip();
    const imgFolder = zip.folder("images");

    for(let i=1; i<=pdf.numPages; i++){
      const page = await pdf.getPage(i);

      const scale = 3; // High resolution
      const viewport = page.getViewport({scale: scale});

      const canvas = document.createElement("canvas");
      const context = canvas.getContext("2d");
      canvas.height = viewport.height;
      canvas.width = viewport.width;

      await page.render({canvasContext: context, viewport: viewport}).promise;

      // show preview
      outputDiv.appendChild(canvas);

      // Convert to JPG Blob
      const blob = await new Promise(res => canvas.toBlob(res, "image/jpeg", 0.92));

      // Add to zip
      imgFolder.file(`page_${i}.jpg`, blob);
    }

    // Generate zip
    const zipBlob = await zip.generateAsync({type:"blob"});
    const zipLink = document.getElementById("zipDownload");
    zipLink.href = URL.createObjectURL(zipBlob);
    zipLink.download = (file.name.replace(/\.pdf$/i,"") || "converted") + "_pages.zip";
    zipLink.style.display = "block";
  };
  reader.readAsArrayBuffer(file);
}
</script>
</body>
</html>
